<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Room</title>
</head>
<body>
    <h1>Welcome to the Chat Room</h1>
    <p id="welcomeMessage"></p>
    <div id="chatContainer">
        <div id="messages"></div>
        <input type="text" id="messageInput" placeholder="Type a message...">
        <button id="sendButton">Send</button>
    </div>

    <!-- Tawk.to Embed Code -->
    <!--Start of Tawk.to Script-->
    <script type="text/javascript">
    var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
    (function(){
        var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
        s1.async=true;
        s1.src='https://embed.tawk.to/66c8e6b1ea492f34bc09790d/1i60ca9h2';
        s1.charset='UTF-8';
        s1.setAttribute('crossorigin','*');
        s0.parentNode.insertBefore(s1,s0);
    })();

    // Get the user's name from the URL
    const urlParams = new URLSearchParams(window.location.search);
    const name = urlParams.get('name');
    document.getElementById('welcomeMessage').textContent = `Hello, ${name}! Welcome to the chat.`;

    // Wait for Tawk.to to load
    Tawk_API.onLoad = function() {
        // Set the visitor's name in Tawk.to
        Tawk_API.setAttributes({
            'name' : name
        }, function(error) {
            if (error) {
                console.error('Error setting Tawk.to attributes:', error);
            }
        });
    };

    // Listen for the Send button click
    document.getElementById('sendButton').addEventListener('click', function() {
        const messageInput = document.getElementById('messageInput');
        const message = messageInput.value;

        // Prepend the user's name to the message
        const finalMessage = `${name}: ${message}`;

        // Send the message through Tawk.to API
        if (Tawk_API.message) {
            Tawk_API.message({
                text: finalMessage,
                type: 'text'
            });
        }

        // Clear the input field after sending the message
        messageInput.value = '';
    });

    </script>
    <!--End of Tawk.to Script-->
</body>
</html>
